<div class="field">
    <label>Name</label>
    <div class="control">
        <input class="input is-link" type="text" name="name" value="{{ item.name ?? '' }}" required>
    </div>
</div>

<div class="field">
    <label>Email</label>
    <div class="control">
        <input class="input is-link" type="email" name="username" value="{{ item.username ?? '' }}" required>
    </div>
</div>

<div class="field">
    <label>Phone</label>
    <div class="control">
        <input class="input is-link" type="text" name="phone" value="{{ item.phone ?? '' }}" required>
    </div>
</div>
<div class="field">
    <label>Gender</label>
    <div class="control">
        <div class="select is-fullwidth is-link">
            <select name="gender" required>
                <option value="">-- Select Gender --</option>
                <option value="Male" {{ item.gender == 'Male' ? 'selected' : '' }}>Male</option>
                <option value="Female" {{ item.gender == 'Female' ? 'selected' : '' }}>Female</option>
            </select>
        </div>
    </div>
</div>
<div class="field">
    <label>Department</label>
    <div class="control">
        <div class="select is-fullwidth is-link">
            <select name="department" required>
                <option value="">-- Select Department --</option>
                <option value="Innovation" {{ item.department == 'Innovation' ? 'selected' : '' }}>Innovation</option>
                <option value="Cybersecurity" {{ item.department == 'Cybersecurity' ? 'selected' : '' }}>Cybersecurity</option>
                <option value="GRC" {{ item.department == 'GRC' ? 'selected' : '' }}>GRC (Governance, Risk, Compliance)</option>
            </select>
        </div>
    </div>
</div>

<div class="field">
    <label>Job Title</label>
    <div class="control">
        <input class="input is-link" type="text" name="job_title" value="{{ item.job_title ?? '' }}">
    </div>
</div>

<div class="field">
    <label>Contract Type</label>
    <div class="control">
        <div class="select is-fullwidth is-link">
            <select name="contract_type" id="{{ prefix }}_contract_type" onchange="toggleContractDates('{{ prefix }}')" required>
                <option value="">-- Select Contract Type --</option>
                <option value="Permanent" {{ item.contract_type == 'Permanent' ? 'selected' : '' }}>Permanent</option>
                <option value="Contract" {{ item.contract_type == 'Contract' ? 'selected' : '' }}>Contract</option>
                <option value="Part-time" {{ item.contract_type == 'Part-time' ? 'selected' : '' }}>Part-time</option>
                <option value="Internship" {{ item.contract_type == 'Internship' ? 'selected' : '' }}>Internship</option>
            </select>
        </div>
    </div>
</div>

<div id="{{ prefix }}_contract-dates" class="is-hidden">
    <div class="field">
        <label>Start Date</label>
        <div class="control">
            <input class="input is-link" type="date" name="contract_start_date" value="{{ item.contract_start_date ?? '' }}">
        </div>
    </div>

    <div class="field">
        <label>End Date</label>
        <div class="control">
            <input class="input is-link" type="date" name="contract_end_date" value="{{ item.contract_end_date ?? '' }}">
        </div>
    </div>
</div>

<div class="field">
    <label>National ID</label>
    <div class="control">
        <input class="input is-link" id="national_id" type="text" name="national_id" value="{{ item.national_id ?? '' }}">
    </div>
</div>

<div class="field">
    <label>Tax ID (ZRA-TPIN)</label>
    <div class="control">
        <input class="input is-link" type="text" name="tax_id" value="{{ item.tax_id ?? '' }}">
    </div>
</div>

<div class="field">
    <label>Napsa SSN</label>
    <div class="control">
        <input class="input is-link" type="text" name="ssn" value="{{ item.ssn ?? '' }}">
    </div>
</div>

<div class="field">
    <label>NHIMA Number</label>
    <div class="control">
        <input class="input is-link" type="text" name="nhima_number" value="{{ item.nhima_number ?? '' }}">
    </div>
</div>
<input class="is-hidden" name="id" value="{{ item.id }}">
<div class="field">
    <label class="">
        Password{% if item.id %} (Optional){% endif %}
    </label>
    <div class="control has-icons-left has-icons-right">
        <input id="password"
               class="input is-link"
               type="password"
               name="password"
               placeholder="********"
               {% if not item.id %}required{% endif %}>
        <span class="icon is-small is-left">
            <i class="mdi mdi-lock-outline"></i>
        </span>
        <span class="icon is-small is-right" onclick="togglePassword()">
            <i class="mdi mdi-eye-off" id="toggleIcon" style="cursor: pointer;"></i>
        </span>
        <small class="errors has-text-danger" id="passwordError"></small>
    </div>
</div>


<script>

    function toggleContractDates(prefix) {
        const typeElement = document.getElementById(prefix + '_contract_type');
        const container = document.getElementById(prefix + '_contract-dates');

        if (!typeElement || !container) return; // stop if elements don't exist

        const type = typeElement.value?.trim();
        if (type === 'Contract' || type === 'Internship') {
            container.classList.remove('is-hidden');
        } else {
            container.classList.add('is-hidden');
        }
    }

    document.addEventListener('DOMContentLoaded', function () {
        // Initialize for both add and edit modes
        ['add', 'edit'].forEach(prefix => {
            toggleContractDates(prefix); // run on load for pre-selected values
            const typeElement = document.getElementById(prefix + '_contract_type');
            if (typeElement) {
                typeElement.addEventListener('change', function () {
                    toggleContractDates(prefix);
                });
            }
        });
    });



</script>


<script>
    document.addEventListener('DOMContentLoaded', function () {
        const nationalIdInput = document.getElementById('national_id');

        nationalIdInput.addEventListener('input', function () {
            let value = nationalIdInput.value.replace(/\D/g, '').slice(0, 10); // Only digits, max 10

            if (value.length > 6) {
                value = value.slice(0, 6) + '/' + value.slice(6);
            }
            if (value.length > 9) {
                value = value.slice(0, 9) + '/' + value.slice(9);
            }

            nationalIdInput.value = value;
        });
    });
</script>
<script>
    function togglePassword() {
        const input = document.getElementById("password");
        const icon = document.getElementById("toggleIcon");
        if (input.type === "password") {
            input.type = "text";
            icon.classList.remove("mdi-eye-off");
            icon.classList.add("mdi-eye");
        } else {
            input.type = "password";
            icon.classList.remove("mdi-eye");
            icon.classList.add("mdi-eye-off");
        }
    }
</script>

